<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LBV API Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <!-- include favicon -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <style>
        .badge-post {
            background-color: #ffcc00;
            /* Replace with your desired color */
            color: #fff;
            /* Text color, adjust if needed */
        }

        .badge-get {
            background-color: #00cd37;
            /* Replace with your desired color */
            color: #fff;
            /* Text color, adjust if needed */
        }

        .badge-put {
            background-color: #0066e2;
            /* Replace with your desired color */
            color: #fff;
            /* Text color, adjust if needed */
        }

        .badge-delete {
            background-color: #ff0000;
            /* Replace with your desired color */
            color: #fff;
            /* Text color, adjust if needed */
        }
    </style>
    <script>
        // On Page Load

        // Check if the user is logged in
        let adminToken = localStorage.getItem('jwtToken');

        // Check if the token exists
        if (!adminToken) {
            // Redirect to /login if there is no token
            window.location.href = '/login';
        } else {
            // Fetch the user's first name using the JWT token
            fetch('/whoami', {
                headers: { 'Authorization': 'Bearer ' + adminToken }
            })
                .then(response => response.json())
                .then(data => {
                    // Display the user's first name
                    document.getElementById('username').textContent = data.Vorname;
                })
                .catch(error => {
                    console.error('Error:', error);

                    // Remove the JWT token from local storage
                    localStorage.removeItem('jwtToken');

                    // Redirect to the home page
                    window.location.href = '/';
                });
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.min.js"></script>





</head>









<body class="container mt-4">
    <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center">
        <h1 class="mb-4">
            LBV-API Admin Dashboard
            <span class="position-absolute top-0 end-0 translate-middle badge rounded-pill bg-primary text-light"
                style="font-size: 0.35em;">
                v1.0
            </span>
        </h1>
        <div class="d-flex align-items-center justify-content-between">
            <span class="mr-3"><span id="timeOfDayGreeting">Guten Tag</span>, <span id="username">User</span></span>

            <script>
                function updateTimeOfDayGreeting() {
                    const now = new Date();
                    const hours = now.getHours();
                    let greeting = "Guten Tag"; // Default greeting

                    if (hours < 12) {
                        greeting = "Guten Morgen";
                    } else if (hours < 14) {
                        greeting = "Guten Mittag";
                    } else if (hours < 17) {
                        greeting = "Guten Nachmittag";
                    } else {
                        greeting = "Guten Abend";
                    }

                    document.getElementById('timeOfDayGreeting').textContent = greeting;
                }

                // Update greeting on page load
                updateTimeOfDayGreeting();
            </script>



            <img id="profilePicture" class="rounded-circle mr-3" style="height: 38px; width: 38px; object-fit: cover;">
            <script>
                // Function to fetch and display the profile picture
                function fetchProfilePicture() {
                    // Get the user ID from the JWT token
                    let adminToken = localStorage.getItem('jwtToken');

                    // Assuming the user ID is stored as a claim in the JWT token
                    // Decode the token to extract the user ID
                    let decodedToken = jwt_decode(adminToken); // Use a suitable JWT decode library
                    let userId = decodedToken.user_id; // Adjust this according to your token structure

                    // API endpoint to fetch the profile picture
                    let profilePictureUrl = `/profile_picture/${userId}`;

                    // Fetch the profile picture
                    fetch(profilePictureUrl, {
                        headers: { 'Authorization': `Bearer ${adminToken}` }
                    })
                        .then(response => {
                            if (response.ok) {
                                return response.blob(); // If image is found, response will be a blob
                            } else {
                                throw new Error('Profilbild nicht gefunden');
                            }
                        })
                        .then(imageBlob => {
                            // Convert the blob to a URL and set it as the src of the image element
                            let imageUrl = URL.createObjectURL(imageBlob);
                            document.getElementById('profilePicture').src = imageUrl;
                        })
                        .catch(error => {
                            console.error('Error:', error.message);
                        });
                }

                // Call the function on page load or at a suitable time
                fetchProfilePicture();
            </script>


            <button id="logoutButton" class="btn btn-outline-danger d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-box-arrow-right" viewBox="0 0 16 16" style="margin-right: 4px;">
                    <path fill-rule="evenodd"
                        d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z">
                    </path>
                    <path fill-rule="evenodd"
                        d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z">
                    </path>
                </svg>
                Abmelden
            </button>
        </div>

    </div>

    <script>
        document.getElementById('logoutButton').addEventListener('click', function () {
            // Remove the JWT token from local storage
            localStorage.removeItem('jwtToken');

            // Redirect to the home page
            window.location.href = '/';
        });
    </script>




    <h2 class="mt-4">Benutzer</h2>
    <!-- Users Section -->
    <div class="accordion" id="usersAccordion">


        <!-- List of All Users -->
        <div class="card">
            <div class="card-header" id="headingUsers">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseUsers" aria-expanded="true" aria-controls="collapseUsers">
                        <span class="badge badge-get">GET</span> Alle Benutzer
                    </button>
                </h2>
            </div>

            <div id="collapseUsers" class="collapse" aria-labelledby="headingUsers" data-parent="#usersAccordion">
                <div class="card-body">
                    <!-- Users List in Table Format -->
                    <table class="table table-bordered">
                        <thead class="thead-light">
                            <tr>
                                <th>Benutzer-ID</th>
                                <th>Vorname</th>
                                <th>E-Mail</th>
                                <th>Passwort</th>
                                <th>Admin</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- User rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

        </div>



        <script>
            function fetchUsers() {
                fetch('/users', {
                    headers: { 'Authorization': 'Bearer ' + adminToken }
                })
                    .then(response => response.json())
                    .then(users => {
                        const tableBody = document.getElementById('usersTableBody');
                        tableBody.innerHTML = ''; // Clear existing content
                        users.forEach(user => {
                            const row = `<tr>
                                        <td>${user.userID}</td>
                                        <td>${user.firstName}</td>
                                        <td>${user.email}</td>
                                        <td>${user.password}</td>
                                        <td>${user.isAdmin ? 'Ja' : 'Nein'}</td>
                                     </tr>`;
                            tableBody.innerHTML += row;
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching users:', error);
                    });
            }

            document.getElementById('headingUsers').addEventListener('click', fetchUsers);
        </script>






        <!-- User Information Retrieval -->
        <div class="card">
            <div class="card-header" id="headingUserInfo">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseUserInfo" aria-expanded="false" aria-controls="collapseUserInfo">
                        <span class="badge badge-get">GET</span> Benutzerinformation abrufen
                    </button>
                </h2>
            </div>

            <div id="collapseUserInfo" class="collapse" aria-labelledby="headingUserInfo" data-parent="#usersAccordion">
                <div class="card-body">
                    <!-- Retrieve User Form -->
                    <form id="getUserForm">
                        <div class="form-group">
                            <label for="userID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="userID" name="userID" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Benutzer abrufen</button>
                    </form>
                    <!-- User Information Display -->
                    <div id="userInfoDisplay" class="mt-3"></div>

                    <script>
                        document.getElementById('getUserForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var userId = document.getElementById('userID').value;
                            fetch(`/users/${userId}`)
                                .then(response => response.json())
                                .then(data => {
                                    var display = document.getElementById('userInfoDisplay');
                                    if (data) {
                                        display.innerHTML = `
                                                     <p>Benutzer-ID: ${data.userID}</p>
                                                     <p>Vorname: ${data.firstName}</p>
                                                     <p>Email: ${data.email}</p>
                                                     <p>Passwort: ${data.password}</p>
                                                     <p>Admin: ${data.isAdmin ? 'Ja' : 'Nein'}</p>`;
                                    } else {
                                        display.innerHTML = `<p>Benutzer nicht gefunden.</p>`;
                                    }
                                })
                                .catch((error) => {
                                    showErrorToast('Benutzer nicht gefunden.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>


        <!-- User Operations -->
        <div class="card">
            <div class="card-header" id="headingUserOperations">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseUserOperations" aria-expanded="false"
                        aria-controls="collapseUserOperations">
                        <span class="badge badge-post">POST</span> Benutzer hinzufügen
                    </button>
                </h2>
            </div>

            <div id="collapseUserOperations" class="collapse" aria-labelledby="headingUserOperations"
                data-parent="#usersAccordion">
                <div class="card-body">
                    <!-- Add User Form -->
                    <form id="addUserForm">
                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>

                        <div class="form-group">
                            <label for="firstName">Vorname:</label>
                            <input type="text" class="form-control" id="firstName" name="firstName" required>
                        </div>

                        <div class="form-group">
                            <label for="password">Passwort:</label>
                            <input type="text" class="form-control" id="password" name="password" required>
                        </div>

                        <div class="form-check mb-3">
                            <input type="checkbox" class="form-check-input" id="isAdmin" name="isAdmin">
                            <label class="form-check-label" for="isAdmin">Ist Admin</label>
                        </div>

                        <button type="submit" class="btn btn-primary">Benutzer hinzufügen</button>
                    </form>

                    <script>
                        document.getElementById('addUserForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var formData = {
                                email: document.getElementById('email').value,
                                firstName: document.getElementById('firstName').value,
                                password: document.getElementById('password').value,
                                isAdmin: document.getElementById('isAdmin').checked
                            };

                            fetch('/users', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(formData)
                            })
                                .then(response => {
                                    if (response.status === 201) {
                                        // Handle successful response
                                        return response.json().then(data => {
                                            showSuccessToast(data.message);
                                        });
                                    } else if (response.status === 400 || response.status === 409) {
                                        // Handle specific error responses (400 Bad Request or 409 Conflict)
                                        return response.json().then(data => {
                                            showErrorToast(data.message);
                                        });
                                    } else {
                                        // Handle other unexpected statuses
                                        throw new Error('Unexpected response status: ' + response.status);
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                    showErrorToast(error.message);
                                });




                        });
                    </script>

                </div>
            </div>
        </div>



        <!-- User Information Update -->
        <div class="card">
            <div class="card-header" id="headingUserUpdate">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseUserUpdate" aria-expanded="false" aria-controls="collapseUserUpdate">
                        <span class="badge badge-put">PUT</span> Benutzerinformation aktualisieren
                    </button>
                </h2>
            </div>

            <div id="collapseUserUpdate" class="collapse" aria-labelledby="headingUserUpdate"
                data-parent="#usersAccordion">
                <div class="card-body">
                    <!-- Update User Form -->
                    <form id="updateUserForm">
                        <div class="form-group">
                            <label for="updateUserID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="updateUserID" name="updateUserID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchUserButton">Benutzerdaten
                            abrufen</button>
                    </form>

                    <!-- Editable User Information Form -->
                    <form id="editUserForm" class="mt-3" style="display:none;">
                        <div class="form-group">
                            <label for="editEmail">Email:</label>
                            <input type="email" class="form-control" id="editEmail" name="email" required>
                        </div>

                        <div class="form-group">
                            <label for="editFirstName">Vorname:</label>
                            <input type="text" class="form-control" id="editFirstName" name="firstName" required>
                        </div>

                        <div class="form-group">
                            <label for="editPassword">Passwort:</label>
                            <input type="password" class="form-control" id="editPassword" name="password" required>
                        </div>

                        <div class="form-check mb-3">
                            <input type="checkbox" class="form-check-input" id="editIsAdmin" name="isAdmin">
                            <label class="form-check-label" for="editIsAdmin">Ist Admin</label>
                        </div>

                        <button type="submit" class="btn btn-success">Änderungen speichern</button>
                    </form>

                    <script>
                        document.getElementById('fetchUserButton').addEventListener('click', function (event) {
                            var userId = document.getElementById('updateUserID').value;
                            fetch(`/users/${userId}`)
                                .then(response => response.json())
                                .then(data => {
                                    if (data) {
                                        document.getElementById('editEmail').value = data.email;
                                        document.getElementById('editFirstName').value = data.firstName;
                                        document.getElementById('editPassword').value = data.password; // Assuming password is retrievable
                                        document.getElementById('editIsAdmin').checked = data.isAdmin;
                                        document.getElementById('editUserForm').style.display = 'block';
                                    } else {
                                        showErrorToast('Benutzer nicht gefunden.');
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });

                        document.getElementById('editUserForm').addEventListener('submit', function (event) {
                            event.preventDefault();
                            var userId = document.getElementById('updateUserID').value;
                            var updatedData = {
                                email: document.getElementById('editEmail').value,
                                firstName: document.getElementById('editFirstName').value,
                                password: document.getElementById('editPassword').value,
                                isAdmin: document.getElementById('editIsAdmin').checked
                            };

                            fetch(`/users/${userId}`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + adminToken  // Include the token in the header
                                },
                                body: JSON.stringify(updatedData)
                            })
                                .then(response => response.json())
                                .then(data => {
                                    showSuccessToast(data.message);
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- End of User Information Update -->

        <!-- User Deletion -->
        <div class="card">
            <div class="card-header" id="headingUserDeletion">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseUserDeletion" aria-expanded="false" aria-controls="collapseUserDeletion">
                        <span class="badge badge-danger">DELETE</span> Benutzer löschen
                    </button>
                </h2>
            </div>

            <div id="collapseUserDeletion" class="collapse" aria-labelledby="headingUserDeletion"
                data-parent="#usersAccordion">
                <div class="card-body">
                    <!-- Fetch User to Delete Form -->
                    <form id="fetchUserToDeleteForm">
                        <div class="form-group">
                            <label for="deleteUserID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="deleteUserID" name="deleteUserID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchUserToDeleteButton">Benutzerdaten
                            abrufen</button>
                    </form>

                    <!-- Display User Information -->
                    <div id="userToDeleteDisplay" class="mt-3"></div>

                    <!-- Delete User Button -->
                    <button type="button" class="btn btn-danger mt-3" id="deleteUserButton"
                        style="display:none;">Benutzer löschen</button>

                    <script>
                        document.getElementById('fetchUserToDeleteButton').addEventListener('click', function (event) {
                            var userId = document.getElementById('deleteUserID').value;
                            fetch(`/users/${userId}`, {
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    if (data) {
                                        document.getElementById('userToDeleteDisplay').innerHTML = `
                                <p>Benutzer-ID: ${data.userID}</p>
                                <p>Vorname: ${data.firstName}</p>
                                <p>Email: ${data.email}</p>`;
                                        document.getElementById('deleteUserButton').style.display = 'block';
                                    } else {
                                        showErrorToast('Benutzer nicht gefunden.');
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });

                        document.getElementById('deleteUserButton').addEventListener('click', function () {
                            var userId = document.getElementById('deleteUserID').value;
                            fetch(`/users/${userId}`, {
                                method: 'DELETE',
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    showSuccessToast(data.message);
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- End of User Deletion -->

    </div>




























    <!-- Groups Section -->
    <h2 class="mt-4">Gruppen</h2>
    <div class="accordion" id="groupsAccordion">

        <!-- List of All Groups -->
        <div class="card">
            <div class="card-header" id="headingGroups">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroups" aria-expanded="true" aria-controls="collapseGroups">
                        <span class="badge badge-get">GET</span> Alle Gruppen
                    </button>
                </h2>
            </div>

            <div id="collapseGroups" class="collapse" aria-labelledby="headingGroups" data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Groups List in Table Format -->
                    <table class="table table-bordered">
                        <thead class="thead-light">
                            <tr>
                                <th>Gruppen-ID</th>
                                <th>Besitzer-ID</th>
                                <th>Titel</th>
                                <th>Beschreibung</th>
                                <th>Maximale Nutzer</th>
                            </tr>
                        </thead>
                        <tbody id="groupsTableBody">
                            <!-- Group rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script>
            function fetchGroups() {
                fetch('/groups', {
                    headers: { 'Authorization': 'Bearer ' + adminToken }
                })
                    .then(response => response.json())
                    .then(groups => {
                        const tableBody = document.getElementById('groupsTableBody');
                        tableBody.innerHTML = ''; // Clear existing content
                        groups.forEach(group => {
                            const row = `<tr>
                                <td>${group.groupID}</td>
                                <td>${group.ownerID}</td>
                                <td>${group.title}</td>
                                <td>${group.description}</td>
                                <td>${group.maxUsers}</td>
                             </tr>`;
                            tableBody.innerHTML += row;
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching groups:', error);
                    });
            }

            document.getElementById('headingGroups').addEventListener('click', fetchGroups);
        </script>


        <!-- Group Information Retrieval -->
        <div class="card">
            <div class="card-header" id="headingGroupInfo">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroupInfo" aria-expanded="false" aria-controls="collapseGroupInfo">
                        <span class="badge badge-get">GET</span> Gruppeninformation abrufen
                    </button>
                </h2>
            </div>

            <div id="collapseGroupInfo" class="collapse" aria-labelledby="headingGroupInfo"
                data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Retrieve Group Form -->
                    <form id="getGroupForm">
                        <div class="form-group">
                            <label for="groupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="groupID" name="groupID" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Gruppe abrufen</button>
                    </form>
                    <!-- Group Information Display -->
                    <div id="groupInfoDisplay" class="mt-3"></div>

                    <script>
                        document.getElementById('getGroupForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var groupId = document.getElementById('groupID').value;
                            fetch(`/groups/${groupId}`)
                                .then(response => response.json())
                                .then(data => {
                                    var display = document.getElementById('groupInfoDisplay');
                                    if (data) {
                                        display.innerHTML = `
                                    <p>Gruppen-ID: ${data.groupID}</p>
                                    <p>Besitzer-ID: ${data.ownerID}</p>
                                    <p>Titel: ${data.title}</p>
                                    <p>Beschreibung: ${data.description}</p>
                                    <p>Maximale Nutzer: ${data.maxUsers}</p>`;
                                    } else {
                                        display.innerHTML = `<p>Gruppe nicht gefunden.</p>`;
                                    }
                                })
                                .catch((error) => {
                                    showErrorToast('Gruppe nicht gefunden.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- Group Members Retrieval -->
        <div class="card">
            <div class="card-header" id="headingGroupMembers">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroupMembers" aria-expanded="false" aria-controls="collapseGroupMembers">
                        <span class="badge badge-get">GET</span> Mitglieder einer Gruppe anzeigen
                    </button>
                </h2>
            </div>

            <div id="collapseGroupMembers" class="collapse" aria-labelledby="headingGroupMembers"
                data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Fetch Group Members Form -->
                    <form id="fetchGroupMembersForm">
                        <div class="form-group">
                            <label for="fetchGroupMembersID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="fetchGroupMembersID" name="fetchGroupMembersID"
                                required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchGroupMembersButton">Mitglieder
                            abrufen</button>
                    </form>

                    <!-- Display Group Members -->
                    <div id="groupMembersDisplay" class="mt-3"></div>

                    <script>
                        document.getElementById('fetchGroupMembersButton').addEventListener('click', function (event) {
                            var groupId = document.getElementById('fetchGroupMembersID').value;
                            fetch(`/groups/${groupId}/members`, {
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(members => {
                                    var display = document.getElementById('groupMembersDisplay');
                                    if (members && members.length > 0) {
                                        var memberList = '<ul>';
                                        members.forEach(member => {
                                            memberList += `<li>Benutzer-ID: ${member.userID}, Beitrittsdatum: ${new Date(member.startingDate).toLocaleDateString()}</li>`;
                                        });
                                        memberList += '</ul>';
                                        display.innerHTML = memberList;
                                    } else {
                                        display.innerHTML = `<p>Keine Mitglieder in dieser Gruppe gefunden.</p>`;
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                    showErrorToast('Fehler beim Abrufen der Mitglieder.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- End of Group Members Retrieval -->
        <!-- Group Operations -->
        <div class="card">
            <div class="card-header" id="headingGroupOperations">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroupOperations" aria-expanded="false"
                        aria-controls="collapseGroupOperations">
                        <span class="badge badge-post">POST</span> Gruppe hinzufügen
                    </button>
                </h2>
            </div>

            <div id="collapseGroupOperations" class="collapse" aria-labelledby="headingGroupOperations"
                data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Add Group Form -->
                    <form id="addGroupForm">
                        <div class="form-group">
                            <label for="ownerID">Besitzer-ID:</label>
                            <input type="number" class="form-control" id="ownerID" name="ownerID" required>
                        </div>

                        <div class="form-group">
                            <label for="title">Titel:</label>
                            <input type="text" class="form-control" id="title" name="title" required>
                        </div>

                        <div class="form-group">
                            <label for="description">Beschreibung:</label>
                            <input type="text" class="form-control" id="description" name="description" required>
                        </div>

                        <div class="form-group">
                            <label for="maxUsers">Maximale Nutzer:</label>
                            <input type="number" class="form-control" id="maxUsers" name="maxUsers" required>
                        </div>

                        <button type="submit" class="btn btn-primary">Gruppe hinzufügen</button>
                    </form>

                    <script>
                        document.getElementById('addGroupForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var formData = {
                                ownerID: document.getElementById('ownerID').value,
                                title: document.getElementById('title').value,
                                description: document.getElementById('description').value,
                                maxUsers: document.getElementById('maxUsers').value
                            };

                            fetch('/groups', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + adminToken
                                },
                                body: JSON.stringify(formData)
                            })
                                .then(response => {
                                    if (response.status === 201) {
                                        // Handle successful response
                                        return response.json().then(data => {
                                            showSuccessToast(data.message);
                                        });
                                    } else if (response.status === 400 || response.status === 409) {
                                        // Handle specific error responses (400 Bad Request or 409 Conflict)
                                        return response.json().then(data => {
                                            showErrorToast(data.message);
                                        });
                                    } else {
                                        // Handle other unexpected statuses
                                        throw new Error('Unexpected response status: ' + response.status);
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                    showErrorToast(error.message);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>





        <!-- Group Information Update -->
        <div class="card">
            <div class="card-header" id="headingGroupUpdate">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroupUpdate" aria-expanded="false" aria-controls="collapseGroupUpdate">
                        <span class="badge badge-put">PUT</span> Gruppeninformation aktualisieren
                    </button>
                </h2>
            </div>

            <div id="collapseGroupUpdate" class="collapse" aria-labelledby="headingGroupUpdate"
                data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Fetch Group Form -->
                    <form id="fetchGroupForm">
                        <div class="form-group">
                            <label for="fetchGroupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="fetchGroupID" name="fetchGroupID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchGroupButton">Gruppendaten
                            abrufen</button>
                    </form>

                    <!-- Editable Group Information Form -->
                    <form id="editGroupForm" class="mt-3" style="display:none;">
                        <div class="form-group">
                            <label for="editTitle">Titel:</label>
                            <input type="text" class="form-control" id="editTitle" name="title" required>
                        </div>

                        <div class="form-group">
                            <label for="editDescription">Beschreibung:</label>
                            <input type="text" class="form-control" id="editDescription" name="description" required>
                        </div>

                        <div class="form-group">
                            <label for="editMaxUsers">Maximale Nutzer:</label>
                            <input type="number" class="form-control" id="editMaxUsers" name="maxUsers" required>
                        </div>

                        <button type="submit" class="btn btn-success">Änderungen speichern</button>
                    </form>

                    <script>
                        document.getElementById('fetchGroupButton').addEventListener('click', function (event) {
                            var groupId = document.getElementById('fetchGroupID').value;
                            fetch(`/groups/${groupId}`, {
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    if (data) {
                                        document.getElementById('editTitle').value = data.title;
                                        document.getElementById('editDescription').value = data.description;
                                        document.getElementById('editMaxUsers').value = data.maxUsers;
                                        document.getElementById('editGroupForm').style.display = 'block';
                                    } else {
                                        showErrorToast('Gruppe nicht gefunden.');
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });

                        document.getElementById('editGroupForm').addEventListener('submit', function (event) {
                            event.preventDefault();
                            var groupId = document.getElementById('fetchGroupID').value;
                            var updatedData = {
                                title: document.getElementById('editTitle').value,
                                description: document.getElementById('editDescription').value,
                                maxUsers: document.getElementById('editMaxUsers').value
                            };

                            fetch(`/groups/${groupId}`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + adminToken
                                },
                                body: JSON.stringify(updatedData)
                            })
                                .then(response => response.json())
                                .then(data => {
                                    showSuccessToast(data.message);
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- End of Group Information Update -->

        <!-- Group Deletion -->
        <div class="card">
            <div class="card-header" id="headingGroupDeletion">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseGroupDeletion" aria-expanded="false"
                        aria-controls="collapseGroupDeletion">
                        <span class="badge badge-danger">DELETE</span> Gruppe löschen
                    </button>
                </h2>
            </div>

            <div id="collapseGroupDeletion" class="collapse" aria-labelledby="headingGroupDeletion"
                data-parent="#groupsAccordion">
                <div class="card-body">
                    <!-- Fetch Group to Delete Form -->
                    <form id="fetchGroupToDeleteForm">
                        <div class="form-group">
                            <label for="deleteGroupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="deleteGroupID" name="deleteGroupID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchGroupToDeleteButton">Gruppendaten
                            abrufen</button>
                    </form>

                    <!-- Display Group Information -->
                    <div id="groupToDeleteDisplay" class="mt-3"></div>

                    <!-- Delete Group Button -->
                    <button type="button" class="btn btn-danger mt-3" id="deleteGroupButton"
                        style="display:none;">Gruppe löschen</button>

                    <script>
                        document.getElementById('fetchGroupToDeleteButton').addEventListener('click', function (event) {
                            var groupId = document.getElementById('deleteGroupID').value;
                            fetch(`/groups/${groupId}`, {
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    if (data) {
                                        document.getElementById('groupToDeleteDisplay').innerHTML = `
                                    <p>Gruppen-ID: ${data.groupID}</p>
                                    <p>Titel: ${data.title}</p>
                                    <p>Beschreibung: ${data.description}</p>`;
                                        document.getElementById('deleteGroupButton').style.display = 'block';
                                    } else {
                                        showErrorToast('Gruppe nicht gefunden.');
                                    }
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });

                        document.getElementById('deleteGroupButton').addEventListener('click', function () {
                            var groupId = document.getElementById('deleteGroupID').value;
                            fetch(`/groups/${groupId}`, {
                                method: 'DELETE',
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(data => {
                                    showSuccessToast(data.message);
                                })
                                .catch((error) => {
                                    console.error('Error:', error);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!-- End of Group Deletion -->




        <!-- Ende Gruppen Verwaltung -->
    </div>



    <!-- Users in Groups Section -->
    <h2 class="mt-4">Benutzer in Gruppen</h2>
    <div class="accordion" id="usersInGroupsAccordion">





        <!-- View All Users in Groups -->
        <div class="card">
            <!-- Card Header -->
            <div class="card-header" id="headingViewUsersInGroups">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseViewUsersInGroups" aria-expanded="false"
                        aria-controls="collapseViewUsersInGroups">
                        <span class="badge badge-get">GET</span> Alle Benutzer in Gruppen anzeigen
                    </button>
                </h2>
            </div>

            <!-- Card Body -->
            <div id="collapseViewUsersInGroups" class="collapse" aria-labelledby="headingViewUsersInGroups"
                data-parent="#usersInGroupsAccordion">
                <div class="card-body">
                    <!-- Display Table -->
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Benutzer-ID</th>
                                <th>Gruppen-ID</th>
                                <th>Beitrittsdatum</th>
                            </tr>
                        </thead>
                        <tbody id="usersInGroupsTableBody">
                            <!-- Data rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script>
            function fetchUsersInGroups() {
                fetch('/users_in_groups', {
                    headers: { 'Authorization': 'Bearer ' + adminToken }
                })
                    .then(response => response.json())
                    .then(usersInGroups => {
                        const tableBody = document.getElementById('usersInGroupsTableBody');
                        tableBody.innerHTML = ''; // Clear existing content
                        usersInGroups.forEach(userInGroup => {
                            const row = `<tr>
                                <td>${userInGroup.userID}</td>
                                <td>${userInGroup.groupID}</td>
                                <td>${new Date(userInGroup.startingDate).toLocaleDateString()}</td>
                             </tr>`;
                            tableBody.innerHTML += row;
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching users in groups:', error);
                    });
            }

            document.getElementById('headingViewUsersInGroups').addEventListener('click', fetchUsersInGroups);
        </script>




        <!-- View Groups for a User -->
        <div class="card">
            <!-- Card Header -->
            <div class="card-header" id="headingViewGroupsForUser">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseViewGroupsForUser" aria-expanded="false"
                        aria-controls="collapseViewGroupsForUser">
                        <span class="badge badge-get">GET</span> Gruppen eines Benutzers anzeigen
                    </button>
                </h2>
            </div>

            <!-- Card Body -->
            <div id="collapseViewGroupsForUser" class="collapse" aria-labelledby="headingViewGroupsForUser"
                data-parent="#usersInGroupsAccordion">
                <div class="card-body">
                    <!-- Form to Fetch Groups for User -->
                    <form id="fetchGroupsForUserForm">
                        <div class="form-group">
                            <label for="fetchUserID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="fetchUserID" name="fetchUserID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchGroupsForUserButton">Gruppen
                            abrufen</button>
                    </form>

                    <!-- Display Groups for User -->
                    <div id="userGroupsDisplay" class="mt-3"></div>

                    <script>
                        document.getElementById('fetchGroupsForUserButton').addEventListener('click', function () {
                            var userId = document.getElementById('fetchUserID').value;
                            fetch(`/users_in_groups/${userId}/`, {
                                headers: { 'Authorization': 'Bearer ' + adminToken }
                            })
                                .then(response => response.json())
                                .then(groups => {
                                    var display = document.getElementById('userGroupsDisplay');
                                    if (groups && groups.length > 0) {
                                        var groupList = '<ul>';
                                        groups.forEach(group => {
                                            groupList += `<li>Gruppen-ID: ${group.groupID}, Beitrittsdatum: ${new Date(group.startingDate).toLocaleDateString()}</li>`;
                                        });
                                        groupList += '</ul>';
                                        display.innerHTML = groupList;
                                    } else {
                                        display.innerHTML = `<p>Keine Gruppen für diesen Benutzer gefunden.</p>`;
                                    }
                                })
                                .catch(error => {
                                    console.error('Error fetching groups for user:', error);
                                });
                        });
                    </script>
                </div>
            </div>
        </div>

        <!-- Add User to Group -->
        <div class="card">
            <!-- Card Header -->
            <div class="card-header" id="headingAddUserToGroup">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseAddUserToGroup" aria-expanded="false"
                        aria-controls="collapseAddUserToGroup">
                        <span class="badge badge-post">POST</span> Benutzer zu Gruppe hinzufügen
                    </button>
                </h2>
            </div>

            <!-- Card Body -->
            <div id="collapseAddUserToGroup" class="collapse" aria-labelledby="headingAddUserToGroup"
                data-parent="#usersInGroupsAccordion">
                <div class="card-body">
                    <!-- Form to Add User to Group -->
                    <form id="addUserToGroupForm">
                        <div class="form-group">
                            <label for="addUserID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="addUserID" name="addUserID" required>
                        </div>

                        <div class="form-group">
                            <label for="addGroupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="addGroupID" name="addGroupID" required>
                        </div>

                        <button type="submit" class="btn btn-primary">Benutzer hinzufügen</button>
                    </form>

                    <script>
                        document.getElementById('addUserToGroupForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var formData = {
                                userID: document.getElementById('addUserID').value,
                                groupID: document.getElementById('addGroupID').value
                            };

                            fetch('/users_in_groups', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + adminToken
                                },
                                body: JSON.stringify(formData)
                            })
                                .then(response => {
                                    if (response.status === 201) {
                                        return response.json().then(data => {
                                            showSuccessToast(data.message);
                                        });
                                    } else {
                                        return response.json().then(data => {
                                            showErrorToast(data.message);
                                        });
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    showErrorToast('Fehler beim Hinzufügen des Benutzers zur Gruppe.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>

        <!-- Remove User from Group -->
        <div class="card">
            <!-- Card Header -->
            <div class="card-header" id="headingRemoveUserFromGroup">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseRemoveUserFromGroup" aria-expanded="false"
                        aria-controls="collapseRemoveUserFromGroup">
                        <span class="badge badge-danger">DELETE</span> Benutzer aus Gruppe entfernen
                    </button>
                </h2>
            </div>

            <!-- Card Body -->
            <div id="collapseRemoveUserFromGroup" class="collapse" aria-labelledby="headingRemoveUserFromGroup"
                data-parent="#usersInGroupsAccordion">
                <div class="card-body">
                    <!-- Form to Remove User from Group -->
                    <form id="removeUserFromGroupForm">
                        <div class="form-group">
                            <label for="removeUserID">Benutzer-ID:</label>
                            <input type="text" class="form-control" id="removeUserID" name="removeUserID" required>
                        </div>

                        <div class="form-group">
                            <label for="removeGroupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="removeGroupID" name="removeGroupID" required>
                        </div>

                        <button type="submit" class="btn btn-danger">Benutzer entfernen</button>
                    </form>

                    <script>
                        document.getElementById('removeUserFromGroupForm').addEventListener('submit', function (event) {
                            event.preventDefault();

                            var userID = document.getElementById('removeUserID').value;
                            var groupID = document.getElementById('removeGroupID').value;

                            fetch(`/users_in_groups/${userID}/${groupID}`, {
                                method: 'DELETE',
                                headers: {
                                    'Authorization': 'Bearer ' + adminToken
                                }
                            })
                                .then(response => {
                                    if (response.status === 200) {
                                        return response.json().then(data => {
                                            showSuccessToast(data.message);
                                        });
                                    } else {
                                        return response.json().then(data => {
                                            showErrorToast(data.message);
                                        });
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    showErrorToast('Fehler beim Entfernen des Benutzers aus der Gruppe.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>
    </div>
    <!-- End of Users in Groups Section -->




    <!-- Dates Section -->
    <h2 class="mt-4">Termine</h2>
    <div class="accordion" id="datesAccordion">

        <!-- View All Dates -->
        <div class="card">
            <div class="card-header" id="headingViewAllDates">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseViewAllDates" aria-expanded="false" aria-controls="collapseViewAllDates">
                        <span class="badge badge-get">GET</span> Alle Termine anzeigen
                    </button>
                </h2>
            </div>
            <div id="collapseViewAllDates" class="collapse" aria-labelledby="headingViewAllDates"
                data-parent="#datesAccordion">
                <div class="card-body">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Gruppen-ID</th>
                                <th>Datum</th>
                                <th>Ort</th>
                                <th>Max. Benutzer</th>
                            </tr>
                        </thead>
                        <tbody id="allDatesTableBody">
                            <!-- Data rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- View Date Details -->
        <div class="card">
            <div class="card-header" id="headingViewDateDetails">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseViewDateDetails" aria-expanded="false"
                        aria-controls="collapseViewDateDetails">
                        <span class="badge badge-get">GET</span> Termin Details anzeigen
                    </button>
                </h2>
            </div>
            <div id="collapseViewDateDetails" class="collapse" aria-labelledby="headingViewDateDetails"
                data-parent="#datesAccordion">
                <div class="card-body">
                    <form id="viewDateDetailsForm">
                        <div class="form-group">
                            <label for="viewDateID">Termin-ID:</label>
                            <input type="text" class="form-control" id="viewDateID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchDateDetailsButton">Termin
                            abrufen</button>
                    </form>
                    <div id="dateDetailsDisplay" class="mt-3"></div>
                </div>
            </div>
        </div>

        <!-- Create Date -->
        <div class="card">
            <div class="card-header" id="headingCreateDate">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                        data-target="#collapseCreateDate" aria-expanded="false" aria-controls="collapseCreateDate">
                        <span class="badge badge-post">POST</span> Neuen Termin erstellen
                    </button>
                </h2>
            </div>
            <div id="collapseCreateDate" class="collapse" aria-labelledby="headingCreateDate"
                data-parent="#datesAccordion">
                <div class="card-body">
                    <form id="createDateForm">
                        <div class="form-group">
                            <label for="createGroupID">Gruppen-ID:</label>
                            <input type="text" class="form-control" id="createGroupID" required>
                        </div>
                        <div class="form-group">
                            <label for="createDate">Datum:</label>
                            <input type="datetime-local" class="form-control" id="createDate" required>
                        </div>
                        <div class="form-group">
                            <label for="createPlace">Ort:</label>
                            <input type="text" class="form-control" id="createPlace" required>
                        </div>
                        <div class="form-group">
                            <label for="createMaxUsers">Maximale Benutzeranzahl:</label>
                            <input type="number" class="form-control" id="createMaxUsers" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Termin erstellen</button>
                    </form>
                    <script>
                        document.getElementById('createDateForm').addEventListener('submit', function (event) {
                            event.preventDefault();
                            var formData = {
                                groupID: document.getElementById('createGroupID').value,
                                date: document.getElementById('createDate').value,
                                place: document.getElementById('createPlace').value,
                                maxUsers: document.getElementById('createMaxUsers').value
                            };
                            fetch('/dates', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + adminToken
                                },
                                body: JSON.stringify(formData)
                            })
                                .then(response => {
                                    if (response.status === 201) {
                                        return response.json().then(data => {
                                            showSuccessToast(data.message);
                                        });
                                    } else {
                                        return response.json().then(data => {
                                            showErrorToast(data.message);
                                        });
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    showErrorToast('Fehler beim Erstellen des Termins.');
                                });
                        });
                    </script>
                </div>
            </div>
        </div>

        <!-- Update Date -->
        <div class="card">
            <div class="card-header" id="headingUpdateDate">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseUpdateDate" aria-expanded="false" aria-controls="collapseUpdateDate">
                        <span class="badge badge-put">PUT</span> Termin bearbeiten
                    </button>
                </h2>
            </div>
            <div id="collapseUpdateDate" class="collapse" aria-labelledby="headingUpdateDate"
                data-parent="#datesAccordion">
                <div class="card-body">
                    <form id="updateDateForm">
                        <div class="form-group">
                            <label for="updateDateID">Termin-ID:</label>
                            <input type="text" class="form-control" id="updateDateID" required>
                        </div>
                        <button type="button" class="btn btn-primary" id="fetchDateForUpdateButton">Termin
                            abrufen</button>
                    </form>
                    <div id="dateToUpdateDisplay" class="mt-3"></div>
                </div>
            </div>
        </div>

        <script>
            // JavaScript for Update Date
            document.getElementById('fetchDateForUpdateButton').addEventListener('click', function () {
                var dateID = document.getElementById('updateDateID').value;
                fetch(`/dates/${dateID}`, {
                    headers: { 'Authorization': 'Bearer ' + adminToken }
                })
                    .then(response => response.json())
                    .then(date => {
                        var display = document.getElementById('dateToUpdateDisplay');
                        display.innerHTML = `
                <form id="editDateForm">
                    <div class="form-group">
                        <label for="editGroupID">Gruppen-ID:</label>
                        <input type="text" class="form-control" id="editGroupID" value="${date.groupID}" required>
                    </div>
                    <div class="form-group">
                        <label for="editDate">Datum:</label>
                        <input type="datetime-local" class="form-control" id="editDate" value="${new Date(date.date).toISOString().slice(0, -1)}" required>
                    </div>
                    <div class="form-group">
                        <label for="editPlace">Ort:</label>
                        <input type="text" class="form-control" id="editPlace" value="${date.place}" required>
                    </div>
                    <div class="form-group">
                        <label for="editMaxUsers">Maximale Benutzeranzahl:</label>
                        <input type="number" class="form-control" id="editMaxUsers" value="${date.maxUsers}" required>
                    </div>
                    <button type="submit" class="btn btn-success">Änderungen speichern</button>
                </form>
            `;
                        attachUpdateFormSubmitHandler(dateID);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            });

            function attachUpdateFormSubmitHandler(dateID) {
                document.getElementById('editDateForm').addEventListener('submit', function (event) {
                    event.preventDefault();
                    var updatedData = {
                        groupID: document.getElementById('editGroupID').value,
                        date: document.getElementById('editDate').value,
                        place: document.getElementById('editPlace').value,
                        maxUsers: document.getElementById('editMaxUsers').value
                    };
                    fetch(`/dates/${dateID}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + adminToken
                        },
                        body: JSON.stringify(updatedData)
                    })
                        .then(handleResponse)
                        .catch(handleError);
                });
            }

            function handleResponse(response) {
                if (response.ok) {
                    return response.json().then(data => {
                        showSuccessToast(data.message);
                    });
                } else {
                    return response.json().then(data => {
                        showErrorToast(data.message);
                    });
                }
            }

            function handleError(error) {
                console.error('Error:', error);
                showErrorToast('Ein Fehler ist aufgetreten.');
            }
        </script>


        <!-- Delete Date -->
        <div class="card">
            <div class="card-header" id="headingDeleteDate">
                <h2 class="mb-0">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseDeleteDate" aria-expanded="false" aria-controls="collapseDeleteDate">
                        <span class="badge badge-danger">DELETE</span> Termin löschen
                    </button>
                </h2>
            </div>
            <div id="collapseDeleteDate" class="collapse" aria-labelledby="headingDeleteDate"
                data-parent="#datesAccordion">
                <div class="card-body">
                    <form id="deleteDateForm">
                        <div class="form-group">
                            <label for="deleteDateID">Termin-ID:</label>
                            <input type="text" class="form-control" id="deleteDateID" required>
                        </div>
                        <button type="button" class="btn btn-danger" id="deleteDateButton">Termin löschen</button>
                    </form>
                </div>
            </div>
        </div>

    </div>
    <!-- End of Dates Section -->

    <script>
        // JavaScript for View All Dates
        document.getElementById('headingViewAllDates').addEventListener('click', function () {
            fetch('/dates', {
                headers: { 'Authorization': 'Bearer ' + adminToken }
            })
                .then(response => response.json())
                .then(dates => {
                    const tableBody = document.getElementById('allDatesTableBody');
                    tableBody.innerHTML = '';
                    dates.forEach(date => {
                        const row = `<tr>
                                <td>${date.id}</td>
                                <td>${date.groupID}</td>
                                <td>${new Date(date.date).toLocaleString()}</td>
                                <td>${date.place}</td>
                                <td>${date.maxUsers}</td>
                            </tr>`;
                        tableBody.innerHTML += row;
                    });
                })
                .catch(error => {
                    console.error('Error fetching dates:', error);
                });
        });

        // JavaScript for View Date Details
        document.getElementById('fetchDateDetailsButton').addEventListener('click', function () {
            var dateID = document.getElementById('viewDateID').value;
            fetch(`/dates/${dateID}`, {
                headers: { 'Authorization': 'Bearer ' + adminToken }
            })
                .then(response => response.json())
                .then(date => {
                    var display = document.getElementById('dateDetailsDisplay');
                    display.innerHTML = `ID: ${date.id}<br>Gruppen-ID: ${date.groupID}<br>Datum: ${new Date(date.date).toLocaleString()}<br>Ort: ${date.place}<br>Max. Benutzer: ${date.maxUsers}`;
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });

        // JavaScript for Delete Date
        document.getElementById('deleteDateButton').addEventListener('click', function () {
            var dateID = document.getElementById('deleteDateID').value;
            fetch(`/dates/${dateID}`, {
                method: 'DELETE',
                headers: { 'Authorization': 'Bearer ' + adminToken }
            })
                .then(handleResponse)
                .catch(handleError);
        });

        function handleResponse(response) {
            if (response.ok) {
                return response.json().then(data => {
                    showSuccessToast(data.message);
                });
            } else {
                return response.json().then(data => {
                    showErrorToast(data.message);
                });
            }
        }

        function handleError(error) {
            console.error('Error:', error);
            showErrorToast('Ein Fehler ist aufgetreten.');
        }
    </script>






























    <div id="toastContainer">
        <!-- Toasts will be added here -->
    </div>


    <style>
        #toastContainer {
            position: fixed;
            bottom: 0;
            right: 0;
            margin-right: 20px;
            margin-bottom: 20px;
            z-index: 11;
        }

        .toast {
            border-radius: 5px;
            margin-top: 10px;
            opacity: 1;
        }

        .toast-success {
            background-color: #28a745;
            color: white;
        }

        .toast-error {
            background-color: #dc3545;
            color: white;
        }
    </style>


    <script>
        function createToast(message, isSuccess) {
            var toast = document.createElement('div');
            toast.className = 'toast align-items-center' + (isSuccess ? ' bg-success text-white' : ' bg-danger text-white');
            toast.role = 'alert';
            toast.ariaLive = 'assertive';
            toast.ariaAtomic = 'true';
            toast.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
            </div>
        `;

            toast.addEventListener('hidden.bs.toast', function () {
                toast.remove();
            });

            document.getElementById('toastContainer').appendChild(toast);
            return toast;
        }

        function showSuccessToast(message) {
            var toastEl = createToast(message, true);
            new bootstrap.Toast(toastEl, { delay: 5000 }).show();
        }

        function showErrorToast(message) {
            var toastEl = createToast(message, false);
            new bootstrap.Toast(toastEl, { delay: 10000 }).show();
        }

        // Example usage
        // showSuccessToast('This is a success message!');
        // showErrorToast('This is an error message!');
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous">
        </script>

</body>

</html>